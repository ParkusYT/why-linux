<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>why-linux report</title>
  <style>
    body { font-family: system-ui, Arial, sans-serif; margin: 20px; }
    .chart { width: 100%; height: 60px; }
    .row { margin-bottom: 18px; }
    .small { color: #666; font-size: 0.9em }
    pre { background: #f6f8fa; padding: 12px; border-radius: 6px }
  </style>
</head>
<body>
  <h1>why-linux report</h1>
  <p class="small">Generated at 1768748043</p>

  <div class="row">
    <h3>CPU (top per-sample)</h3>
    <svg id="cpu" class="chart"></svg>
  </div>

  <div class="row">
    <h3>Memory (top per-sample)</h3>
    <svg id="mem" class="chart"></svg>
  </div>

  <div class="row">
    <h3>Disk usage (top per-sample)</h3>
    <svg id="disk" class="chart"></svg>
  </div>

  <h3>Summary</h3>
  <pre id="summary"></pre>

  <script>
    const samples = [
  {
    "ts": 1768748038,
    "cpu": {
      "name": "firefox",
      "pid": 5395,
      "cpu": 30.7
    },
    "mem": {
      "name": "firefox",
      "pid": 5395,
      "mem": 3.3,
      "used_percent": 23.015827
    },
    "disk": {
      "fs": "/dev/nvme0n1p2",
      "mount": "/",
      "used_percent": 71.0
    }
  },
  {
    "ts": 1768748039,
    "cpu": {
      "name": "firefox",
      "pid": 5395,
      "cpu": 30.7
    },
    "mem": {
      "name": "firefox",
      "pid": 5395,
      "mem": 3.3,
      "used_percent": 22.967287
    },
    "disk": {
      "fs": "/dev/nvme0n1p2",
      "mount": "/",
      "used_percent": 71.0
    }
  },
  {
    "ts": 1768748040,
    "cpu": {
      "name": "firefox",
      "pid": 5395,
      "cpu": 30.7
    },
    "mem": {
      "name": "firefox",
      "pid": 5395,
      "mem": 3.3,
      "used_percent": 22.957798
    },
    "disk": {
      "fs": "/dev/nvme0n1p2",
      "mount": "/",
      "used_percent": 71.0
    }
  },
  {
    "ts": 1768748041,
    "cpu": {
      "name": "firefox",
      "pid": 5395,
      "cpu": 30.7
    },
    "mem": {
      "name": "firefox",
      "pid": 5395,
      "mem": 3.3,
      "used_percent": 22.884785
    },
    "disk": {
      "fs": "/dev/nvme0n1p2",
      "mount": "/",
      "used_percent": 71.0
    }
  },
  {
    "ts": 1768748042,
    "cpu": {
      "name": "firefox",
      "pid": 5395,
      "cpu": 30.7
    },
    "mem": {
      "name": "firefox",
      "pid": 5395,
      "mem": 3.3,
      "used_percent": 22.633791
    },
    "disk": {
      "fs": "/dev/nvme0n1p2",
      "mount": "/",
      "used_percent": 71.0
    }
  }
];
    const summary = {
  "cpu": {
    "cpu": 30.700000762939453,
    "name": "firefox",
    "pid": 5395
  }
};

    function sparkline(values, el) {
      const rect = el.getBoundingClientRect();
      const w = Math.max(1, Math.floor(rect.width)) || 600;
      const h = 60;
      if (!values || values.length === 0) {
        el.setAttribute('viewBox', `0 0 ${w} ${h}`);
        el.innerHTML = '';
        return;
      }
      const maxv = Math.max(...values, 1);
      const minv = Math.min(...values);
      const step = w / Math.max(values.length - 1, 1);
      let path = '';
      values.forEach(function(v,i){
        const x = i * step;
        const y = h - ((v - minv)/(maxv - minv || 1)) * (h - 4) - 2;
        path += (i==0 ? ('M ' + x + ' ' + y) : (' L ' + x + ' ' + y));
      });
      el.setAttribute('viewBox', `0 0 ${w} ${h}`);
      el.innerHTML = '<path d="' + path + '" fill="none" stroke="#1976d2" stroke-width="2"/>';
    }

    // prepare numeric series
    const cpuSeries = samples.map(s=> s.cpu ? s.cpu.cpu : 0);
    const memSeries = samples.map(s=> s.mem ? s.mem.mem : 0);
    const diskSeries = samples.map(s=> s.disk ? s.disk.used_percent : 0);

    document.addEventListener('DOMContentLoaded', function() {
      sparkline(cpuSeries, document.getElementById('cpu'));
      sparkline(memSeries, document.getElementById('mem'));
      sparkline(diskSeries, document.getElementById('disk'));
      document.getElementById('summary').textContent = JSON.stringify(summary, null, 2);
    });
  </script>
</body>
</html>